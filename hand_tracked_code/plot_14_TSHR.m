function [] = plot_14_TSHR()
    points = load('TSHR_points.mat').TSHR_points;
    cells = get_cells();
    bpts = get_bpts();
    
    figure;
    for i=1:size(cells,1)
        plot_cells_1(cells(i,1), cells(i,2), points);
    end
    
    plot_bpts(bpts, points);
    
    missing_pairs = [12, 14;
        34, 36;
        92, 94;
        118, 119;
        125, 127;
        180, 182;
        224, 226;
        236, 238;
        262, 264;
        288, 290;
        323, 325;
        345, 347;
        353, 355;
        371, 374;
        439, 441;
        448, 450;
        499, 501;
        542, 544;
        558, 560;
        634, 636;
        643, 644;
        686, 688;
        755, 757;
        782, 784;
        883, 885;
        902, 904;
        919, 921;
        947, 949;
        987, 989;
        1039, 1041;
        1071, 1073;
        1087, 1089;
        1151, 1153;
        1157, 1159;
        1226, 1228;
        1265, 1267;
        1321, 1323;
        1439, 1442;
        1470, 1472;
        1519, 1521;
        1652, 1654;
        1671, 1673;
        1702, 1704;
        1766, 1768;
        1832, 1834;
        1855, 1857;
        1885, 1887;
        2013, 2015;
        2039, 2041;
        2086, 2089;
        2114, 2115;
        2122, 2124;
        2168, 2170;
        2185, 2187;
        2245, 2247;
        2256, 2258;
        2263, 2265;
        2296, 2298;
        2307, 2309;
        2355, 2357;
        2387, 2389;
        2422, 2424;
        2444, 2446;
        2693, 2696;
        2694, 2701];
    
    for i=1:size(missing_pairs,1)
        connect_pts(missing_pairs(i,1),  missing_pairs(i,2), points);
    end
    
    missing_cells = [2696, 2700;
        2701, 2704;
        2446, 2450;
        998, 1039];
 
    for i=1:size(missing_cells,1)
        plot_cells_1(missing_cells(i,1),  missing_cells(i,2), points);
    end
    
    figure;
end


function [] = plot_cells_1 (startpt, endpt, points) 
    for i=startpt:endpt-1
        x = [points(i, 1), points(i+1, 1)];
        y = [points(i, 2), points(i+1, 2)];
        z = [points(i, 3) , points(i+1, 3)];
        plot3(x, y, z, "Color", "b");
        
        hold on;
    end
end

function [] = plot_bpts(bpts, points)
    for i = 1:size(bpts,1)
        x1 = points(bpts(i,1), :);
        plot3(x1(1), x1(2), x1(3), 'ro');
        x2 = points(bpts(i,2), :);
        x3 = points(bpts(i,3), :);
        line([x2(1), x3(1)],[x2(2), x3(2)],[x2(3), x3(3)]);
        hold on;
    end
    
end

function [] = connect_pts(pt1, pt2, points)
    pt1 = points(pt1, :);
    pt2 = points(pt2, :);
    x = [pt1(1), pt2(1)];
    y = [pt1(2), pt2(2)];
    z = [pt1(3), pt2(3)];
    
    line(x, y, z);
end


function cells = get_cells()
cells = [1 12
14 34
36 83
84 92
94 118
119 125
127 143
144 155
157 180
182 224
226 231
232 236
238 262
264 272
273 288
290 323
325 345
347 353
355 357
358 371
374 421
422 439
441 448
450 493
493 499
501 508
509 542
544 558
560 571
472 631
632 634
636 643
644 686
688 714
715 746
748 755
757 782
784 830
831 883
885 902
904 913
914 919
921 947
949 987
989 997
1042 1071
1073 1087
1089 1110
1111 1151
1153 1157
1159 1170
1171 1226
1228 1252
1253 1265
1267 1321
1323 1335
1336 1415
1416 1439
1442 1470
1472 1499
1500 1519
1521 1581
1582 1652
1654 1663
1664 1671
1673 1689
1690 1702
1704 1724
1726 1766
1768 1807
1808 1832
1834 1855
1857 1885
1887 1891
1892 1903
1904 1984
1985 2013
2015 2039
2041 2065
2066 2086
2089 2114
2115 2122
2124 2140
2141 2149
2150 2168
2170 2185
2187 2232
2233 2245
2247 2256
2258 2263
2265 2296
2298 2307
2309 2319
2320 2355
2357 2387
2389 2402
2403 2422
2424 2438
2441 2443
2452 2477
2478 2499
2501 2503
2504 2507
2508 2509
2511 2515 
2516 2544
2545 2550 
2551 2556
2557 2566
2567 2569
2579 2599
2600 2607
2613 2628
2630 2637
2639 2660
2705 2712];
end

function bpts = get_bpts()
bpts = [93   92 2443 
119  188 2444
126  125 272 
156  155 245 
181  180 298 
237  236 2478 
263  262 2501 
289  288 2509 
324  323 206 
354  353 2504 
372  371 373 
373  372 508 
440  439 2510 
500  278 499 
559  558 2511 
747  603 746 
756  1992 755 
783  782 864 
884  883 2516 
903  902 2140 
920  919 2545 
948  947 2556 
988  987 2557 
1040  1039 2567 
1152  1151 2570 
1440  1439 2600 
1690  1689 1606 
1725  1724 34 
1767  1766 2612 
2014  2013 2452 
2040  2039 2613 
2115  2114 2630 
2123  2122 2477 
2186  2438 2185 
2264  2263 2551 
2297  2296 2639 
2356  2355 2661 
2423  2422 1601 
2439  2438 2185 
2440  2441 150 
2500  2499 1023 
2608  1366 2607 
2629  1826 2084 
2638  2637 687 
2695  2693 2694];
end