function [] = plot_SHRT()
    points = load('SHRT_points.mat').SHRT_points;
    points = points(:, 6:8);
    c_1 = get_cells();
    bpts = get_bpts();
    figure;
    
    for i=1:size(c_1,1)
         plot_cells_1(c_1(i,1), c_1(i,2), points);
    end
    
    plot_bpts(bpts, points);
    
    missing_pairs = [1227, 1230
        1229, 1234;
        3023, 3025;
        2471, 2474;
        2472, 2493;
        2473, 2510;
        3134, 3136;
        3136, 3138;
        1898, 1912];
    
    for i=1:size(missing_pairs,1)
         connect_pts(missing_pairs(i,1),  missing_pairs(i,2), points);
    end
    
    
    missing_cells = [1230, 1232;
        1234, 1238;
        2943, 3023;
        2474, 2492;
        2493, 2509;
        2510, 2513;
        3117, 3134;
        3138, 3152;
        1912, 1924];
    
    for i=1:size(missing_cells,1)
         plot_cells_1(missing_cells(i,1),  missing_cells(i,2), points);
    end
end

function [] = connect_pts(pt1, pt2, points)
    pt1 = points(pt1, :);
    pt2 = points(pt2, :);
    x = [pt1(1), pt2(1)];
    y = [pt1(2), pt2(2)];
    z = [pt1(3), pt2(3)];
    
    line(x, y, z);
end
function [] = plot_cells_1 (startpt, endpt, points) 
    for i=startpt:endpt-1
        x = [points(i, 1), points(i+1, 1)];
        y = [points(i, 2), points(i+1, 2)];
        z = [points(i, 3) , points(i+1, 3)];
        plot3(x, y, z, "Color", "b");
        
        hold on;
    end
end

function [] = plot_bpts(bpts, points)
    for i = 1:size(bpts,1)
        x1 = points(bpts(i,1), :);
        plot3(x1(1), x1(2), x1(3), 'ro');
        x2 = points(bpts(i,2), :);
        x3 = points(bpts(i,3), :);
        line([x2(1), x3(1)],[x2(2), x3(2)],[x2(3), x3(3)]);
        hold on;
    end
    
end

function cells_1 = get_cells()
cells_1 = [1,86
87,92
94,101
103,174
175,186
188,250
252,262
263,318
320,337
338,350
352,353
355,414
416,427
428,430
432,441
442,479
481,525
527,529
530,533
534,547
548,584
585,606
608,609
614,674
611,613
676,739
740,769
771,785
787,806
808,812
814,829
830,835
837,890
892,898
900,917
918,921
922,947
950,986
987,1016
1018,1024
1026,1058
1059,1061
1063,1064
1066,1126
1128,1153
1154,1166
1168,1181
1182,1196
1197,1228
1240,1262
1264,1275
1277,1306
1308,1321
1323,1325
1327,1329
1330,1336
1337,1353
1355,1401
1403,1443
1445,1489
1490,1495
1497,1529 
1532,1562
1564,1568
1570,1578
1580,1583
1584,1601
1602,1603
1605,1616
1618,1622
1623,1645
1646,1705
1707,1732
1733,1742
1744,1788
1790,1821
1823,1895
1897,1911
1926,2011
2012,2070
2072,2098
2099,2130
2132,2146
2149,2182
2186,2190
2192,2239
2241,2256
2258,2276
2278,2297
2298,2318
2319,2350
2351,2385
2387,2437
2438,2470
2515,2525
2527,2546
2547,2583
2585,2623
2624,2629
2630,2632
2634,2670
2671,2710
2712,2758
2759,2790
2792,2803
2804,2815
2817,2853
2854,2877
2879,2929
2930,2941
3023,3024
3023,3026
3029,3058
3060,3063
3064,3115
3153,3159
3161,3195
3197,3200
3202,3244
3246,3291
3292,3322
3324,3343
3344,3381
3381,2759
3382,3467
3468,3547
3547,2624
3548,3622
3624,3653
3654,3675
3676,3704
3706,3805
3806,3835
3837,3851];


% cells_2 = [
% 1227, 1230-1232
% 1229, 1234-1238
% 2943-3023, 3025
% 2471, 2474-2492
% 2472, 2493-2509
% 2473, 2510-2513
% 3117-3134, 3136, 3138-3152
% 1898, 1912-1924];

end

function bpts = get_bpts()
bpts = [93 548 92
102 101 547
251 2792 250
319 318 3624
351 350 352
415 428 414
480 479 481
526 525 530
583 581 127
607 606 611
610 613 609
675 611 676
770 1063 769
807 3654 806
813 1058 812
891 922 890
899 921 898
1017 1016 1063
1025 1059 1024
1062 481 1062
1065 771 1064
1127 1126 1154
1167 1166 1182
1228 1227 1229
1233 1232 687
1239 1238 297
1263 1262 1645
1276 1275 1601
1322 1321 1330
1402 1401 1158
1496 1495 1622
1530 1529 1280
1531 1441 1529
1563 1562 1270
1569 1568 3724
1579 1578 3806
1617 1616 1546
1822 1330 1815
1896 1895 1897
1925 1895 1898
2071 2070 3837
2131 2130 2350
2146 2147 2148
2185 2184 2624
2191 2148 3514
2240 2258 2239
2257 2256 1798
2277 2276 2298
2386 2385 2438
2510 2509 2489
2514 2421 2513
2526 2525 2547
2546 2348 2545
2584 2583 2630
2633 2853 2632
2711 2759 2710
2791 2790 1995
2816 2815 2854
2942 1657 2941
3025 3024 3026
3027 3026 1817
3028 1698 3029
3059 3058 3024
3116 3115 3161
3135 3153 3134
3137 3136 3196
3160 1722 3159
3201 3200 2747
3245 3244 2715
3291 3292 3324
3623 3622 3141
3705 1781 3706
3836 3835 2763
3852 3851 1898];
end